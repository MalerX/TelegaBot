LET currentTimestamp = DATE_NOW()
LET twelveHoursAgo = DATE_SUBTRACT(currentTimestamp, 12, "hour")

FOR w IN weather
  LET dateInSeconds = DATE_TIMESTAMP(w.date, "%Y-%m-%d")
  LET twelveHoursAgoInSeconds = DATE_TIMESTAMP(twelveHoursAgo, "%Y-%m-%d")
  FILTER w.city == @city && dateInSeconds >= twelveHoursAgoInSeconds
  SORT w.date DESC
  LIMIT 1
RETURN w